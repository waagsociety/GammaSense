!function(){"use strict";function t(t,e){function n(e){return t+e}return void 0!==e?n(e):n}function e(t,e){var n=void 0===e;return function(r){var a=r.length,o=n-1;if(n&&(e=r[0]),a)for(;++o<a;)e=t(e,r[o]);return e}}function n(){return e(t)(arguments)/arguments.length}function r(t,e){for(var n in e)t[n]=e[n];return t}function a(t){return document.createElement(t)}function o(t,e){return t.drawImage(e,0,0),t}function i(t,e){var n=e.width,r=e.height;return t.getImageData(0,0,n,r)}function u(t){return function(e){return e.getContext(t)}}function c(t){var e=r(a("canvas"),t),n=k(e);return function(e){return i(o(n,e),t)}}function s(t,e){var n=k(t);return n.putImageData(e,0,0),n}function f(t){return function(e){return function(n){function r(e){return setInterval(a,t)}function a(){o!==!1&&e(n)!==!1||(n.srcObject.getVideoTracks().forEach(function(t){return t.stop()}),n.src="",clearInterval(i)),o=!0}var o=e(n)!==!1,i=o&&r(a);return null}}}function l(t,e,n){return.2126*t+.7152*e+.0722*n}function v(t,e){for(var n=t.data,r=n.length,a=0,o={time:Date.now(),resolution:r/4,distribution:Array(255).fill(0),gamma:0};a<r;){var i=a++,u=a++,c=a++,s=a++,f=l(n[i],n[u],n[c]),v=f>0,d=e(f);n[i]=d[0],n[u]=d[1],n[c]=d[2],n[s]=d[3],o.gamma+=v,o.distribution[0|f]+=1}return{imageData:t,sample:o}}function d(t,e){return function(n){var r=c({width:n.videoWidth,height:n.videoHeight}),a=r(n),o=v(a,e);return t(o)}}function g(t,e){function n(t,e){var n=t-e,r=255/(255-e);return 0|n*r}function r(t){return[255,255,255,255]}return e=e||r,function(r){return r>=t?e(n(r,t)):[0,0,0,255]}}function h(t,e){var n=a("video"),r=f(t);return function(t,a){var o=d(t,a);navigator.mediaDevices.getUserMedia(e).then(function(t){n.srcObject=t,n.onloadedmetadata=function(t){return r(o)(n)}}).catch(console.warn)}}function m(t,e){var r=6e4,a=e.querySelector("circle"),o=e.querySelector("text"),i=a.getTotalLength(),u=Date.now();a.style.strokeDasharray=i,a.style.strokeDashoffset=0;var c=[],f=[],l=0,v=0;return function(e){var d=e.sample,g=e.imageData,h=Date.now()-u;if(h>=r){var m=v/l,y=d.resolution/100;f.push(m/y),o.textContent=Math.round(100*n.apply(void 0,f))/100,c.push({start:u,count:l,total:v,gamma:m}),u=Date.now(),v=0,l=0}else a.style.strokeDashoffset=-(h/1e3*(i/(r/1e3/2))),v+=d.gamma,++l;var D=g.width,w=g.height;return t.width=D,t.height=w,s(t,g),q}}function y(t){var e=0|.75*t;return[128-e,255,192-e,255]}var D={name:"Making Sense"},w={samples:{low:50,medium:1e3,high:1e3},interval:250,treshold:0},p={audio:!1,video:{mandatory:{maxWidth:640,maxHeight:480}}},S={meta:D,sensor:w,video:p},k=u("2d"),q=!1;!function(t){var e=t.querySelector("canvas"),n=t.querySelector("svg"),r=t.querySelector("#measure-start"),a=t.querySelector("#measure-stop"),o=h(250,S.video);r.addEventListener("click",function(r){t.classList.toggle("is-active"),o(m(e,n),g(2,y)),q=!0}),a.addEventListener("click",function(e){t.classList.toggle("is-active"),q=!1})}(document.querySelector("#monitor"))}();
